{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useAnimatedQRCodePlayer = void 0;\n\nconst react_1 = __importStar(require(\"react\"));\n\nconst rxjs_1 = require(\"rxjs\");\n\nconst BaseQRCode_1 = require(\"../components/BaseQRCode\");\n\nconst bc_ur_1 = require(\"@cvbb/bc-ur\");\n\nconst events_1 = require(\"events\");\n\nconst Button_1 = require(\"../components/Button\");\n\nconst ButtonGroup_1 = require(\"../components/ButtonGroup\");\n\nconst useAnimatedQRCodePlayer = () => {\n  const [data, setData] = react_1.useState([]);\n  const [refreshSpeed, setRefreshSpeed] = react_1.useState(500);\n  const [hasNext, setHasNext] = react_1.useState(false);\n  const [index, setIndex] = react_1.useState(0);\n  const [title, setTitle] = react_1.useState(null);\n  const [description, setDescription] = react_1.useState(null);\n  const [isPause, setPause] = react_1.useState(false);\n\n  const pause = () => {\n    setPause(true);\n  };\n\n  const play = () => {\n    setPause(false);\n  };\n\n  const next = () => {\n    setIndex(index => {\n      if (index >= splitArray.length - 1) {\n        return 0;\n      } else {\n        return index + 1;\n      }\n    });\n  };\n\n  const prev = () => {\n    setIndex(index => {\n      if (index < 0) {\n        return splitArray.length - 1;\n      } else {\n        return index - 1;\n      }\n    });\n  };\n\n  const ee = react_1.useMemo(() => new events_1.EventEmitter(), []);\n  const splitArray = data;\n\n  const reset = () => {\n    setData([]);\n    setRefreshSpeed(500);\n    setIndex(0);\n  };\n\n  react_1.useEffect(() => {\n    if (!isPause) {\n      const subscribe = rxjs_1.interval(refreshSpeed).subscribe(() => {\n        next();\n      });\n      return () => {\n        subscribe.unsubscribe();\n      };\n    }\n  }, [refreshSpeed, splitArray, isPause]);\n\n  const finish = () => {\n    ee.emit('finish', true);\n  };\n\n  const element = react_1.default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    }\n  }, title && react_1.default.createElement(\"p\", null, title), description && react_1.default.createElement(\"p\", null, description), react_1.default.createElement(BaseQRCode_1.BaseQRCode, {\n    size: 288,\n    data: splitArray[index]\n  }), react_1.default.createElement(\"p\", {\n    style: {\n      textAlign: 'center'\n    }\n  }, index + 1, \"/\", splitArray.length), react_1.default.createElement(ButtonGroup_1.ButtonGroup, null, isPause ? react_1.default.createElement(Button_1.Button, {\n    onClick: play\n  }, \"Play\") : react_1.default.createElement(Button_1.Button, {\n    onClick: pause\n  }, \"Pause\"), react_1.default.createElement(Button_1.Button, {\n    onClick: next\n  }, \"Next\"), react_1.default.createElement(Button_1.Button, {\n    onClick: prev\n  }, \"Prev\")), react_1.default.createElement(ButtonGroup_1.ButtonGroup, null, react_1.default.createElement(Button_1.Button, {\n    onClick: finish\n  }, hasNext ? 'Next' : 'Finish')));\n  return [element, {\n    play: (data, options) => {\n      return new Promise(resolve => {\n        const urs = bc_ur_1.encodeUR(data, 800);\n        setData(urs);\n\n        if (options) {\n          options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n          options.hasNext && setHasNext(options.hasNext);\n          options.title && setTitle(options.title);\n          options.description && setDescription(options.description);\n        }\n\n        ee.once('finish', () => {\n          reset();\n          resolve();\n        });\n      });\n    }\n  }];\n};\n\nexports.useAnimatedQRCodePlayer = useAnimatedQRCodePlayer;","map":{"version":3,"sources":["../../lib/hooks/useAnimatedQRCodePlayer.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.useAnimatedQRCodePlayer = void 0;\nconst react_1 = __importStar(require(\"react\"));\nconst rxjs_1 = require(\"rxjs\");\nconst BaseQRCode_1 = require(\"../components/BaseQRCode\");\nconst bc_ur_1 = require(\"@cvbb/bc-ur\");\nconst events_1 = require(\"events\");\nconst Button_1 = require(\"../components/Button\");\nconst ButtonGroup_1 = require(\"../components/ButtonGroup\");\nconst useAnimatedQRCodePlayer = () => {\n    const [data, setData] = react_1.useState([]);\n    const [refreshSpeed, setRefreshSpeed] = react_1.useState(500);\n    const [hasNext, setHasNext] = react_1.useState(false);\n    const [index, setIndex] = react_1.useState(0);\n    const [title, setTitle] = react_1.useState(null);\n    const [description, setDescription] = react_1.useState(null);\n    const [isPause, setPause] = react_1.useState(false);\n    const pause = () => {\n        setPause(true);\n    };\n    const play = () => {\n        setPause(false);\n    };\n    const next = () => {\n        setIndex((index) => {\n            if (index >= splitArray.length - 1) {\n                return 0;\n            }\n            else {\n                return index + 1;\n            }\n        });\n    };\n    const prev = () => {\n        setIndex((index) => {\n            if (index < 0) {\n                return splitArray.length - 1;\n            }\n            else {\n                return index - 1;\n            }\n        });\n    };\n    const ee = react_1.useMemo(() => new events_1.EventEmitter(), []);\n    const splitArray = data;\n    const reset = () => {\n        setData([]);\n        setRefreshSpeed(500);\n        setIndex(0);\n    };\n    react_1.useEffect(() => {\n        if (!isPause) {\n            const subscribe = rxjs_1.interval(refreshSpeed).subscribe(() => {\n                next();\n            });\n            return () => {\n                subscribe.unsubscribe();\n            };\n        }\n    }, [refreshSpeed, splitArray, isPause]);\n    const finish = () => {\n        ee.emit('finish', true);\n    };\n    const element = (react_1.default.createElement(\"div\", { style: {\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n        } },\n        title && react_1.default.createElement(\"p\", null, title),\n        description && react_1.default.createElement(\"p\", null, description),\n        react_1.default.createElement(BaseQRCode_1.BaseQRCode, { size: 288, data: splitArray[index] }),\n        react_1.default.createElement(\"p\", { style: { textAlign: 'center' } },\n            index + 1,\n            \"/\",\n            splitArray.length),\n        react_1.default.createElement(ButtonGroup_1.ButtonGroup, null,\n            isPause ? react_1.default.createElement(Button_1.Button, { onClick: play }, \"Play\") : react_1.default.createElement(Button_1.Button, { onClick: pause }, \"Pause\"),\n            react_1.default.createElement(Button_1.Button, { onClick: next }, \"Next\"),\n            react_1.default.createElement(Button_1.Button, { onClick: prev }, \"Prev\")),\n        react_1.default.createElement(ButtonGroup_1.ButtonGroup, null,\n            react_1.default.createElement(Button_1.Button, { onClick: finish }, hasNext ? 'Next' : 'Finish'))));\n    return [\n        element,\n        {\n            play: (data, options) => {\n                return new Promise((resolve) => {\n                    const urs = bc_ur_1.encodeUR(data, 800);\n                    setData(urs);\n                    if (options) {\n                        options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n                        options.hasNext && setHasNext(options.hasNext);\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                    }\n                    ee.once('finish', () => {\n                        reset();\n                        resolve();\n                    });\n                });\n            },\n        },\n    ];\n};\nexports.useAnimatedQRCodePlayer = useAnimatedQRCodePlayer;\n//# sourceMappingURL=useAnimatedQRCodePlayer.js.map"]},"metadata":{},"sourceType":"script"}