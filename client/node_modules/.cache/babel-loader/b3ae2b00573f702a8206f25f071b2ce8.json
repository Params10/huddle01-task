{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopDefault(ex) {\n  return ex && typeof ex === 'object' && 'default' in ex ? ex['default'] : ex;\n}\n\nfunction _interopNamespace(e) {\n  if (e && e.__esModule) {\n    return e;\n  } else {\n    var n = {};\n\n    if (e) {\n      Object.keys(e).forEach(function (k) {\n        var d = Object.getOwnPropertyDescriptor(e, k);\n        Object.defineProperty(n, k, d.get ? d : {\n          enumerable: true,\n          get: function () {\n            return e[k];\n          }\n        });\n      });\n    }\n\n    n['default'] = e;\n    return n;\n  }\n}\n\nvar ReactDOM = _interopDefault(require('react-dom'));\n\nvar React = require('react');\n\nvar React__default = _interopDefault(React);\n\nvar Modal = _interopDefault(require('react-modal'));\n\nvar events = require('events');\n\nvar rxjs = require('rxjs');\n\nvar QRCode = _interopDefault(require('qrcode.react'));\n\nvar bcUr = require('@ngraveio/bc-ur');\n\nconst BaseQRCode = ({\n  size = 200,\n  data = '',\n  ecl = 'L'\n}) => {\n  return React__default.createElement(QRCode, {\n    value: data,\n    size: size,\n    level: ecl\n  });\n};\n\n(function (ReadStatus) {\n  ReadStatus[\"canceled\"] = \"canceled\";\n  ReadStatus[\"success\"] = \"success\";\n})(exports.ReadStatus || (exports.ReadStatus = {}));\n\n(function (PlayStatus) {\n  PlayStatus[\"canceled\"] = \"canceled\";\n  PlayStatus[\"success\"] = \"success\";\n})(exports.PlayStatus || (exports.PlayStatus = {}));\n\n(function (SupportedResult) {\n  SupportedResult[\"UR_BYTES\"] = \"bytes\";\n  SupportedResult[\"UR_CRYPTO_HDKEY\"] = \"crypto-hdkey\";\n  SupportedResult[\"UR_ETH_SIGN_REQUEST\"] = \"eth-sign-request\";\n  SupportedResult[\"UR_ETH_SIGNATURE\"] = \"eth-signature\";\n})(exports.SupportedResult || (exports.SupportedResult = {}));\n\nconst styleBase = {\n  minWidth: '16rem',\n  height: '3rem',\n  background: '#784FFE',\n  borderColor: 'grey',\n  borderRadius: '8px',\n  borderWidth: 1,\n  color: 'white',\n  outline: 'none',\n  margin: 2\n};\n\nconst Button = props => {\n  const {\n    onClick,\n    children\n  } = props;\n  return React__default.createElement(\"button\", {\n    onClick: onClick,\n    style: styleBase\n  }, children);\n};\n\nconst ButtonGroup = props => {\n  return React__default.createElement(\"div\", {\n    style: {\n      width: '100%',\n      marginTop: '1rem',\n      display: 'flex',\n      flexDirection: 'row-reverse',\n      alignItems: 'center',\n      justifyContent: 'center'\n    }\n  }, props.children);\n};\n\nconst DEFAULT_SPEED = 100;\nconst DEFAULT_UR = /*#__PURE__*/new bcUr.UR( /*#__PURE__*/Buffer.from('NO DATA', 'utf-8'));\n\nconst useAnimatedQRCodePlayer = () => {\n  const [data, setData] = React.useState(DEFAULT_UR);\n  const [shouldShow, setShouldShow] = React.useState(false);\n  const [refreshSpeed, setRefreshSpeed] = React.useState(DEFAULT_SPEED);\n  const [hasNext, setHasNext] = React.useState(false);\n  const [title, setTitle] = React.useState(null);\n  const [description, setDescription] = React.useState(null);\n  const urEncoder = React.useMemo(() => new bcUr.UREncoder(data), [data]);\n  const [qr, setQR] = React.useState(urEncoder.nextPart());\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n\n  const reset = () => {\n    setData(DEFAULT_UR);\n    setShouldShow(false);\n    setRefreshSpeed(DEFAULT_SPEED);\n  };\n\n  React.useEffect(() => {\n    if (urEncoder.cbor.toString('hex') !== DEFAULT_UR.cbor.toString('hex')) {\n      setShouldShow(true);\n    }\n  }, [urEncoder]);\n  React.useEffect(() => {\n    const subscribe = rxjs.interval(refreshSpeed).subscribe(() => {\n      setQR(urEncoder.nextPart());\n    });\n    return () => {\n      subscribe.unsubscribe();\n    };\n  }, [refreshSpeed, urEncoder]);\n\n  const finish = () => {\n    ee.emit('finish', true);\n  };\n\n  const element = shouldShow ? React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    }\n  }, title && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold'\n    }\n  }, title), React__default.createElement(BaseQRCode, {\n    size: 288,\n    data: qr\n  }), description && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1rem',\n      textAlign: 'center'\n    }\n  }, description), React__default.createElement(ButtonGroup, null, React__default.createElement(Button, {\n    onClick: finish\n  }, hasNext ? 'Scan Keystone' : 'Finish'))) : React__default.createElement(\"div\", null);\n  return [element, {\n    play: (data, options) => {\n      return new Promise(resolve => {\n        setData(data);\n\n        if (options) {\n          options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n          options.hasNext && setHasNext(options.hasNext);\n          options.title && setTitle(options.title);\n          options.description && setDescription(options.description);\n        }\n\n        ee.once('finish', () => {\n          reset();\n          resolve(exports.PlayStatus.success);\n        });\n      });\n    }\n  }];\n};\n\nclass URTypeError extends Error {\n  constructor(msg) {\n    super(msg); // Set the prototype explicitly.\n\n    Object.setPrototypeOf(this, URTypeError.prototype);\n  }\n\n}\n\nconst LoadingSpinner = () => {\n  return React__default.createElement(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    style: {\n      margin: 'auto',\n      display: 'block',\n      shapeRendering: 'auto',\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    },\n    width: \"200px\",\n    height: \"200px\",\n    viewBox: \"0 0 100 100\",\n    preserveAspectRatio: \"xMidYMid\"\n  }, React__default.createElement(\"circle\", {\n    cx: \"50\",\n    cy: \"50\",\n    fill: \"none\",\n    stroke: \"#9b9b9b\",\n    strokeWidth: \"7\",\n    r: \"35\",\n    strokeDasharray: \"164.93361431346415 56.97787143782138\",\n    style: {\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    }\n  }, React__default.createElement(\"animateTransform\", {\n    attributeName: \"transform\",\n    type: \"rotate\",\n    repeatCount: \"indefinite\",\n    dur: \"1s\",\n    values: \"0 50 50;360 50 50\",\n    keyTimes: \"0;1\",\n    style: {\n      animationPlayState: 'running',\n      animationDelay: '0s'\n    }\n  })));\n};\n\nconst QrReader = /*#__PURE__*/React__default.lazy(() => new Promise(function (resolve) {\n  resolve(_interopNamespace(require('react-qr-reader')));\n}));\nlet URTypeErrorMessage = '';\n\nconst useAnimatedQRCodeReader = () => {\n  const [cameraReady, setCameraReady] = React.useState(false);\n  const [expectTypes, setExpectTypes] = React.useState([]);\n  const [urDecoder, setURDecoder] = React.useState(new bcUr.URDecoder());\n  const [error, setError] = React.useState('');\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n  const [title, setTitle] = React.useState(null);\n  const [progress, setProgress] = React.useState(0);\n  const [description, setDescription] = React.useState(null);\n\n  const reset = () => {\n    setURDecoder(new bcUr.URDecoder());\n    setError('');\n  };\n\n  const processQRCode = (qr, errorMessgeOnURType) => {\n    processUR(qr, errorMessgeOnURType);\n  };\n\n  const handleStop = () => {\n    ee.emit('read', {\n      status: 'canceled'\n    });\n  };\n\n  const handleRetry = () => {\n    reset();\n  };\n\n  const processUR = (ur, errorMessgeOnURType) => {\n    try {\n      if (!urDecoder.isComplete()) {\n        urDecoder.receivePart(ur);\n        setProgress(urDecoder.getProgress());\n      } else {\n        const result = urDecoder.resultUR();\n        let foundExpected = false;\n        expectTypes.forEach(et => {\n          if (et === result.type) {\n            foundExpected = true;\n            ee.emit('read', {\n              result,\n              status: 'success'\n            });\n            return;\n          }\n        });\n        if (!foundExpected) throw new URTypeError(`received ur type ${result.type}, but expected [${expectTypes.join(',')}]`);\n      }\n    } catch (e) {\n      if (e instanceof URTypeError) {\n        setError(errorMessgeOnURType);\n      } else {\n        setError(e.message);\n      }\n    }\n  };\n\n  const element = React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center'\n    }\n  }, title && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold'\n    }\n  }, title), description && React__default.createElement(\"p\", {\n    style: {\n      fontSize: '1rem',\n      textAlign: 'center'\n    }\n  }, description), React__default.createElement(React.Suspense, {\n    fallback: React__default.createElement(\"div\", null)\n  }, React__default.createElement(\"div\", {\n    style: {\n      position: 'relative',\n      width: '100%'\n    }\n  }, !cameraReady ? React__default.createElement(\"div\", {\n    style: {\n      position: 'absolute',\n      top: '50%',\n      left: '50%',\n      transform: 'translate(-50%, -50%)'\n    }\n  }, React__default.createElement(LoadingSpinner, null)) : null, React__default.createElement(QrReader, {\n    onScan: data => {\n      if (data) {\n        setCameraReady(true);\n        processQRCode(data, URTypeErrorMessage);\n      }\n    },\n    delay: 100,\n    style: {\n      width: '100%'\n    },\n    onError: e => {\n      setError(e.message);\n    }\n  }))), React__default.createElement(\"p\", null, (progress * 100).toFixed(0), \" %\"), error && React__default.createElement(\"p\", {\n    style: {\n      color: 'red',\n      fontSize: '1rem'\n    }\n  }, error), React__default.createElement(ButtonGroup, null, React__default.createElement(Button, {\n    onClick: handleStop\n  }, \"Close\"), error && React__default.createElement(Button, {\n    onClick: handleRetry\n  }, \"Retry\")));\n  return [element, {\n    read: (expect, options) => {\n      return new Promise(resolve => {\n        setExpectTypes(expect);\n\n        if (options) {\n          options.title && setTitle(options.title);\n          options.description && setDescription(options.description);\n          URTypeErrorMessage = options.URTypeErrorMessage ? options.URTypeErrorMessage : '';\n        }\n\n        ee.once('read', result => {\n          reset();\n          resolve(result);\n        });\n      });\n    },\n    cameraReady\n  }];\n};\n\nconst InitialPage = props => {\n  return React__default.createElement(\"div\", {\n    style: {\n      paddingLeft: '1rem'\n    }\n  }, React__default.createElement(\"div\", {\n    style: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: 0\n    }\n  }, React__default.createElement(\"img\", {\n    style: {\n      display: 'inline-block'\n    },\n    src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=\",\n    alt: \"\"\n  }), React__default.createElement(\"div\", {\n    style: {\n      fontSize: '1.25rem',\n      fontWeight: 'bold',\n      marginLeft: '1rem'\n    }\n  }, \"Sync Keystone\")), React__default.createElement(\"ul\", {\n    style: {\n      marginTop: '2rem',\n      listStyleType: 'none',\n      padding: 0,\n      fontSize: '1rem'\n    }\n  }, React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, \"1. Turn on your Keystone hardware device\"), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, `2. Select your \"${props.walletMode}\" as your Watch-only wallet(Companion App)`), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, \" 3. Press the \\\"Scan Keystone\\\" button and scan the QR Code displayed on your Keystone hardware wallet\"), React__default.createElement(\"li\", {\n    style: {\n      marginBottom: '0.75rem'\n    }\n  }, \" 4. Select account and check your watch-only wallet\")), React__default.createElement(\"div\", {\n    style: {\n      marginBottom: '1rem'\n    }\n  }, React__default.createElement(\"a\", {\n    style: {\n      marginTop: '1.25rem',\n      color: '#784FFE',\n      textDecoration: 'none'\n    },\n    href: props.link,\n    target: \"_blank\"\n  }, \"Click here to view detailed tutorial\")), React__default.createElement(Button, {\n    onClick: props.onButtonClick\n  }, \"Sync Keystone\"));\n};\n\nconst customStyles = {\n  overlay: {\n    zIndex: 999\n  },\n  content: {\n    top: '50%',\n    left: '50%',\n    right: 'auto',\n    bottom: 'auto',\n    borderRadius: '10px',\n    width: '37rem',\n    marginRight: '-50%',\n    transform: 'translate(-50%, -50%)',\n    postion: 'relative'\n  }\n};\n\nconst useController = () => {\n  const ee = React.useMemo(() => new events.EventEmitter(), []);\n  const [visible, setVisible] = React.useState(false);\n  const [walletMode, setWalltMode] = React.useState('');\n  const [link, setLink] = React.useState('');\n  const [mode, setMode] = React.useState(null);\n  const [AnimatedQRCodePlayer, {\n    play\n  }] = useAnimatedQRCodePlayer();\n  const [AnimatedQRCodeReader, {\n    read,\n    cameraReady\n  }] = useAnimatedQRCodeReader();\n\n  const close = () => {\n    ee.emit('close');\n    reset();\n  };\n\n  const reset = () => {\n    setMode(null);\n    setLink('');\n    setWalltMode('');\n    setVisible(false);\n  };\n\n  const goToRead = () => {\n    setMode('read');\n  };\n\n  const renderPannel = pageMode => {\n    if (pageMode === 'initial') {\n      return React__default.createElement(InitialPage, {\n        walletMode: walletMode,\n        link: link,\n        onButtonClick: goToRead\n      });\n    } else if (pageMode === 'read') {\n      return AnimatedQRCodeReader;\n    } else if (pageMode === 'play') {\n      return AnimatedQRCodePlayer;\n    } else {\n      return null;\n    }\n  };\n\n  const element = React__default.createElement(Modal, {\n    isOpen: visible,\n    style: customStyles\n  }, React__default.createElement(\"div\", {\n    onClick: close\n  }, React__default.createElement(\"img\", {\n    style: {\n      position: 'absolute',\n      top: '1rem',\n      right: '1rem'\n    },\n    src: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg==\"\n  })), React__default.createElement(\"div\", {\n    style: {\n      width: '35rem',\n      padding: 18,\n      flex: 1,\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      color: '#002237'\n    }\n  }, renderPannel(mode)));\n  return [element, {\n    play: (data, options) => {\n      return new Promise(async resolve => {\n        ee.once('close', () => {\n          resolve(exports.PlayStatus.canceled);\n        });\n        setVisible(true);\n        setMode('play');\n        await play(data, options);\n        reset();\n        resolve(exports.PlayStatus.success);\n      });\n    },\n    read: async (expect, options) => {\n      if (options.renderInitial) {\n        setWalltMode(options.renderInitial.walletMode);\n        setLink(options.renderInitial.link);\n        setMode('initial');\n        setVisible(true);\n        const result = await read(expect, options);\n        reset();\n        return result;\n      } else {\n        setMode('read');\n        setVisible(true);\n        const result = await read(expect, options);\n        reset();\n        return result;\n      }\n    },\n    cameraReady\n  }];\n};\n\nvar Root = () => {\n  const [Controller, {\n    read,\n    play,\n    cameraReady\n  }] = useController();\n  setupSdk(read, play, cameraReady);\n  return Controller;\n};\n\nlet initialized = false;\nlet read;\nlet play;\nlet cameraReady;\n\nconst bootstrap = () => {\n  const htmlBody = document.getElementsByTagName('body').item(0);\n  const sdkDiv = document.createElement('div');\n  sdkDiv.id = 'kv_sdk_container';\n  htmlBody.appendChild(sdkDiv);\n  Modal.setAppElement('#kv_sdk_container');\n  ReactDOM.render(React__default.createElement(Root), sdkDiv);\n};\n\nconst setupSdk = (r, p, status) => {\n  initialized = true;\n  read = r;\n  play = p;\n  cameraReady = status;\n};\n\nconst sdk = {\n  bootstrap,\n  getSdk: () => {\n    if (initialized) {\n      return {\n        read,\n        play,\n        cameraReady\n      };\n    } else {\n      throw new Error('SDK is not initialized');\n    }\n  }\n};\nexports.default = sdk;","map":{"version":3,"sources":["../src/components/BaseQRCode.tsx","../src/types.ts","../src/components/Button.tsx","../src/components/ButtonGroup.tsx","../src/hooks/useAnimatedQRCodePlayer.tsx","../src/error.ts","../src/components/LoadingSpinner.tsx","../src/hooks/useAnimatedQRCodeReader.tsx","../src/components/InitialPage.tsx","../src/hooks/useController.tsx","../src/Root.tsx","../src/service.ts"],"names":["BaseQRCode","size","data","ecl","value","level","ReadStatus","PlayStatus","SupportedResult","styleBase","minWidth","height","background","borderColor","borderRadius","borderWidth","color","outline","margin","Button","props","children","onClick","style","ButtonGroup","width","marginTop","display","flexDirection","alignItems","justifyContent","DEFAULT_SPEED","DEFAULT_UR","UR","Buffer","useAnimatedQRCodePlayer","useState","urEncoder","useMemo","UREncoder","ee","EventEmitter","reset","setData","setShouldShow","setRefreshSpeed","useEffect","subscribe","setQR","finish","element","shouldShow","title","fontSize","fontWeight","qr","description","textAlign","React","hasNext","play","resolve","options","setHasNext","setTitle","setDescription","URTypeError","Error","constructor","msg","Object","LoadingSpinner","xmlns","shapeRendering","animationPlayState","animationDelay","viewBox","preserveAspectRatio","cx","cy","fill","stroke","strokeWidth","r","strokeDasharray","attributeName","type","repeatCount","dur","values","keyTimes","QrReader","URTypeErrorMessage","useAnimatedQRCodeReader","URDecoder","setURDecoder","setError","processQRCode","processUR","handleStop","status","handleRetry","urDecoder","setProgress","result","foundExpected","expectTypes","et","e","Suspense","fallback","position","top","left","transform","onScan","setCameraReady","delay","onError","progress","error","read","setExpectTypes","cameraReady","InitialPage","paddingLeft","padding","src","alt","marginLeft","listStyleType","marginBottom","walletMode","textDecoration","href","link","target","onButtonClick","customStyles","overlay","zIndex","content","right","bottom","marginRight","postion","useController","close","setMode","setLink","setWalltMode","setVisible","goToRead","renderPannel","pageMode","isOpen","visible","flex","setupSdk","initialized","bootstrap","htmlBody","document","sdkDiv","Modal","ReactDOM","sdk","getSdk"],"mappings":"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","sourcesContent":["import React from 'react';\nimport QRCode from 'qrcode.react';\n\nexport const BaseQRCode = ({\n    size = 200,\n    data = '',\n    ecl = 'L',\n}: {\n    data: string;\n    size?: number;\n    ecl?: 'L' | 'M' | 'Q' | 'H';\n}) => {\n    return <QRCode value={data} size={size} level={ecl} />;\n};\n","import { UR } from '@ngraveio/bc-ur';\n\ntype DecodedSuccess = {\n    result: UR;\n    status: ReadStatus.success;\n};\n\ntype DecodedCanceled = {\n    status: ReadStatus.canceled;\n};\n\nexport type DecodedResult = DecodedSuccess | DecodedCanceled;\n\nexport enum ReadStatus {\n    canceled = 'canceled',\n    success = 'success',\n}\n\nexport enum PlayStatus {\n    canceled = 'canceled',\n    success = 'success',\n}\n\nexport type Play = (\n    data: UR,\n    options?: {\n        refreshSpeed?: number;\n        hasNext?: boolean;\n        title?: string;\n        description?: string;\n    },\n) => Promise<PlayStatus>;\n\nexport type Read = (\n    expect: SupportedResult[],\n    options?: {\n        title?: string;\n        description?: string;\n        renderInitial?: {\n            walletMode: string;\n            link: string;\n        };\n        URTypeErrorMessage?: string;\n    },\n) => Promise<DecodedResult>;\n\nexport enum SupportedResult {\n    UR_BYTES = 'bytes',\n    UR_CRYPTO_HDKEY = 'crypto-hdkey',\n    UR_ETH_SIGN_REQUEST = 'eth-sign-request',\n    UR_ETH_SIGNATURE = 'eth-signature',\n}\n","import React, { FunctionComponent } from 'react';\n\ntype Props = {\n    onClick: () => any;\n};\n\nconst styleBase = {\n    minWidth: '16rem',\n    height: '3rem',\n    background: '#784FFE',\n    borderColor: 'grey',\n    borderRadius: '8px',\n    borderWidth: 1,\n    color: 'white',\n    outline: 'none',\n    margin: 2,\n};\n\nexport const Button: FunctionComponent<Props> = (props) => {\n    const { onClick, children } = props;\n    return (\n        <button onClick={onClick} style={styleBase}>\n            {children}\n        </button>\n    );\n};\n","import React, { FunctionComponent } from 'react';\n\nexport const ButtonGroup: FunctionComponent = (props) => {\n    return (\n        <div\n            style={{\n                width: '100%',\n                marginTop: '1rem',\n                display: 'flex',\n                flexDirection: 'row-reverse',\n                alignItems: 'center',\n                justifyContent: 'center',\n            }}\n        >\n            {props.children}\n        </div>\n    );\n};\n","import React, { useEffect, useMemo, useState } from 'react';\nimport { interval } from 'rxjs';\nimport { BaseQRCode } from '../components/BaseQRCode';\nimport { Play, PlayStatus } from '../types';\nimport { EventEmitter } from 'events';\nimport { Button } from '../components/Button';\nimport { ButtonGroup } from '../components/ButtonGroup';\nimport { UR, UREncoder } from '@ngraveio/bc-ur';\n\nconst DEFAULT_SPEED = 100;\n\nconst DEFAULT_UR = new UR(Buffer.from('NO DATA', 'utf-8'));\n\nexport const useAnimatedQRCodePlayer = (): [JSX.Element, { play: Play }] => {\n    const [data, setData] = useState<UR>(DEFAULT_UR);\n    const [shouldShow, setShouldShow] = useState(false);\n\n    const [refreshSpeed, setRefreshSpeed] = useState(DEFAULT_SPEED);\n    const [hasNext, setHasNext] = useState(false);\n    const [title, setTitle] = useState<string | null>(null);\n    const [description, setDescription] = useState<string | null>(null);\n\n    const urEncoder = useMemo(() => new UREncoder(data), [data]);\n\n    const [qr, setQR] = useState<string>(urEncoder.nextPart());\n\n    const ee = useMemo(() => new EventEmitter(), []);\n    const reset = () => {\n        setData(DEFAULT_UR);\n        setShouldShow(false);\n        setRefreshSpeed(DEFAULT_SPEED);\n    };\n\n    useEffect(() => {\n        if (urEncoder.cbor.toString('hex') !== DEFAULT_UR.cbor.toString('hex')) {\n            setShouldShow(true);\n        }\n    }, [urEncoder]);\n\n    useEffect(() => {\n        const subscribe = interval(refreshSpeed).subscribe(() => {\n            setQR(urEncoder.nextPart());\n        });\n        return () => {\n            subscribe.unsubscribe();\n        };\n    }, [refreshSpeed, urEncoder]);\n\n    const finish = () => {\n        ee.emit('finish', true);\n    };\n\n    const element = shouldShow ? (\n        <div\n            style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n            }}\n        >\n            {title && <p style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{title}</p>}\n            <BaseQRCode size={288} data={qr} />\n            {description && <p style={{ fontSize: '1rem', textAlign: 'center' }}>{description}</p>}\n            <ButtonGroup>\n                <Button onClick={finish}>{hasNext ? 'Scan Keystone' : 'Finish'}</Button>\n            </ButtonGroup>\n        </div>\n    ) : (\n        <div></div>\n    );\n\n    return [\n        element,\n        {\n            play: (data, options) => {\n                return new Promise((resolve) => {\n                    setData(data);\n                    if (options) {\n                        options.refreshSpeed && setRefreshSpeed(options.refreshSpeed);\n                        options.hasNext && setHasNext(options.hasNext);\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                    }\n                    ee.once('finish', () => {\n                        reset();\n                        resolve(PlayStatus.success);\n                    });\n                });\n            },\n        },\n    ];\n};\n","export class URTypeError extends Error {\n    constructor(msg: string) {\n        super(msg);\n\n        // Set the prototype explicitly.\n        Object.setPrototypeOf(this, URTypeError.prototype);\n    }\n}\n","import React from 'react';\n\nexport const LoadingSpinner = () => {\n    return (\n        <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            style={{ margin: 'auto', display: 'block', shapeRendering: 'auto', animationPlayState: 'running', animationDelay: '0s' }}\n            width=\"200px\"\n            height=\"200px\"\n            viewBox=\"0 0 100 100\"\n            preserveAspectRatio=\"xMidYMid\">\n            <circle cx=\"50\" cy=\"50\" fill=\"none\" stroke=\"#9b9b9b\" strokeWidth=\"7\" r=\"35\" strokeDasharray=\"164.93361431346415 56.97787143782138\"\n                style={{ animationPlayState: 'running', animationDelay: '0s' }}>\n                <animateTransform attributeName=\"transform\" type=\"rotate\" repeatCount=\"indefinite\" dur=\"1s\" values=\"0 50 50;360 50 50\" keyTimes=\"0;1\"\n                    style={{ animationPlayState: 'running', animationDelay: '0s' }}>\n                </animateTransform>\n            </circle>\n        </svg>\n    );\n};\n","import React, { useMemo, useState, Suspense } from 'react';\nimport { EventEmitter } from 'events';\nimport { Button } from '../components/Button';\nimport { URTypeError } from '../error';\n\nimport { Read, SupportedResult } from '../types';\nimport { ButtonGroup } from '../components/ButtonGroup';\nimport { LoadingSpinner } from '../components/LoadingSpinner'\nimport { URDecoder } from '@ngraveio/bc-ur';\n\n\nconst QrReader = React.lazy(() => import(\"react-qr-reader\"));\n\nexport interface URQRCodeData {\n    total: number;\n    index: number;\n    data: string;\n}\n\nlet URTypeErrorMessage: string = '';\n\nexport const useAnimatedQRCodeReader = (): [JSX.Element, { read: Read; cameraReady: boolean; }] => {\n    const [cameraReady, setCameraReady] = useState<boolean>(false);\n    const [expectTypes, setExpectTypes] = useState<SupportedResult[]>([]);\n    const [urDecoder, setURDecoder] = useState(new URDecoder());\n    const [error, setError] = useState('');\n    const ee = useMemo(() => new EventEmitter(), []);\n    const [title, setTitle] = useState<string | null>(null);\n    const [progress, setProgress] = useState(0);\n    const [description, setDescription] = useState<string | null>(null);\n    const reset = () => {\n        setURDecoder(new URDecoder());\n        setError('');\n    };\n\n    const processQRCode = (qr: string, errorMessgeOnURType: string) => {\n        processUR(qr, errorMessgeOnURType);\n    };\n\n    const handleStop = () => {\n        ee.emit('read', {\n            status: 'canceled',\n        });\n    };\n\n    const handleRetry = () => {\n        reset();\n    };\n\n    const processUR = (ur: string, errorMessgeOnURType: string) => {\n        try {\n            if (!urDecoder.isComplete()) {\n                urDecoder.receivePart(ur);\n                setProgress(urDecoder.getProgress());\n            } else {\n                const result = urDecoder.resultUR();\n                let foundExpected = false;\n                expectTypes.forEach((et) => {\n                    if (et === result.type) {\n                        foundExpected = true;\n                        ee.emit('read', {\n                            result,\n                            status: 'success',\n                        });\n                        return;\n                    }\n                });\n                if (!foundExpected) throw new URTypeError(`received ur type ${result.type}, but expected [${expectTypes.join(',')}]`);\n            }\n        } catch (e) {\n            if (e instanceof URTypeError) {\n                setError(errorMessgeOnURType)\n            } else {\n                setError(e.message);\n            }\n        }\n    };\n\n    const element = (\n        <div\n            style={{\n                display: 'flex',\n                flexDirection: 'column',\n                alignItems: 'center',\n            }}\n        >\n            {title && <p style={{ fontSize: '1.25rem', fontWeight: 'bold' }}>{title}</p>}\n            {description && <p style={{ fontSize: '1rem', textAlign: 'center' }}>{description}</p>}\n            <Suspense fallback={<div />}>\n                <div style={{position: 'relative', width: '100%'}}>\n                    {!cameraReady ? <div style={{position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)'}}><LoadingSpinner /></div> : null}\n                    <QrReader\n                        onScan={(data: any) => {\n                            if (data) {\n                                setCameraReady(true);\n                                processQRCode(data, URTypeErrorMessage);\n                            }\n                        }}\n                        delay={100}\n                        style={{ width: '100%' }}\n                        onError={(e) => {\n                            setError(e.message);\n                        }}\n                    />\n                </div>\n            </Suspense>\n            <p>{(progress * 100).toFixed(0)} %</p>\n            {error && <p style={{ color: 'red', fontSize: '1rem' }}>{error}</p>}\n            <ButtonGroup>\n                <Button onClick={handleStop}>Close</Button>\n                {error && <Button onClick={handleRetry}>Retry</Button>}\n            </ButtonGroup>\n\n        </div>\n    );\n\n    return [\n        element,\n        {\n            read: (expect, options) => {\n                return new Promise((resolve) => {\n                    setExpectTypes(expect);\n                    if (options) {\n                        options.title && setTitle(options.title);\n                        options.description && setDescription(options.description);\n                        URTypeErrorMessage = options.URTypeErrorMessage ? options.URTypeErrorMessage : '';\n                    }\n                    ee.once('read', (result) => {\n                        reset();\n                        resolve(result);\n                    });\n                });\n            },\n            cameraReady,\n        },\n    ];\n};\n","import React from 'react';\nimport { Button } from './Button'\n\nexport const InitialPage = (props:{walletMode:string, link: string, onButtonClick:() => void}) => {\n    return (\n        <div style={{paddingLeft: '1rem'}}>\n            <div style={{display : 'flex', alignItems: 'center', padding: 0}}>\n                <img style={{display: 'inline-block'}} \n                src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAoCAYAAACfKfiZAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAKAAAAACc9ikyAAAD+ElEQVRYCb1WbWiNURw/Z9caY5SyrKzVhuUtZcYoJdZ8kMywGClG+WK+eJsPmogNKfZBxBbmAyPyEgvtA8UUX9inbVeb8AGTd8t2j9/vdp91ntPzPPd57h3/+t1z/uf/ev7nnP9zhUiMsmH2BOgF9ifmIjmrVpgrDWuScxfMeqUW2EqiB2sjgrlJTDsNZmHACqyP2xJzGcyq2iU4E7kTzFVw7fEw+Qbou9bn94K7FCIlgNFh6I7y0E8oAQ9/NlEBuAig71ifv4VspM1iiJnHHsGZyPohjmdzxzeu79acsyFJm8UQMnzbfONmUIvnsRTG4g3DWAM8B24DM4GkaR88WMGcxkYtQr2h+wl8niYPPJ0Aix+AU2Cu8UlmASRe0gHA1L1JYaLUBEPToc7v1hx7XdISTc/3tAiaXs+uE3K2ZdJaQE/MnLdDzvvhm3ij2wDTkc4vj3lLx/gmji7tqmL6voYNcRze17zwv4CemNuc/xt8NSoqsau5OfoD2TSAxDb+EXDTNdeX0igeHYSCaajzfGoWZWDidU90O84XWIZuYw4EvwDT0OK527GG8VUPfcuO4wPAsVvqt/MolIYDbsSmxLPUiS+gEpgBOH1Z+7HOC90MMBFXYnn0jM35S8hDrtZJCFgBluZEHB/bIWenc6XVV1Qo/MCxCoM2ucUi0lwubX4YfBng1TKvQ1426MWY1NSolAs94jJKVoYaOh2DbqGw3ddQqutqkGcooEG5rmHM+8DvMNZs7KVuUaiUWOUjOO0k9HIjSpzOq1RRv0xgus2jnTkONhxbKsZ4A7gFlMbWRChddMLtZ4v3O0YiojZvq8rkEbwCrOai278Dkw98BxYBLYD+anaB58sREzerosiAaMExjCbvl0KpooAV6HIx2IN1Bk8FTgF6cLDiCLCTk86z8mlKSCzBbr6S90NSooumiXYm8MjBgG+3KbZehXGygw6XmAQrEU0C77TETxII3ofA6zrrZR+PIAvoBrhTEnvAPIBJZAIdQLzS8r8BkxGTNqq5AxLHocQY8iYxOIKuwCu4Sxkr8B7g5bLoIiYMTjoExAtOvTqASYiORtmmJCohxRfyBv3GeqkVnDJWgLQQaAV45iw3k5oKsAMySb9UDcVaKuduUYWiX1xDObPJI/AHDBXhBsnvwiBZCXChAuA/nWdkQLxg0bJGOf8/tDtG9fxNKqNfisX4ZKamC/Gw/Zzs9e9GiL1Q5n0ICn6A5gQJ5KY7C4Ig33s90WibdXOsr3ud7wsoshcwiaAUPfegRm76syHgBylINaIX0c1hout8FecB/i/Uy23OedvZP/4Z5cDzSeAnYAZnK54P/BcahygHAD5dNh12tilAIPoLD0OnpwCV000AAAAASUVORK5CYII=\" alt=\"\" />\n                <div style={{fontSize: '1.25rem', fontWeight: 'bold', marginLeft: '1rem' }}>\n                    Sync Keystone</div>\n            </div>\n            <ul style={{marginTop: '2rem', listStyleType: 'none', padding: 0, fontSize: '1rem'}}>\n                <li style={{marginBottom: '0.75rem'}}>1. Turn on your Keystone hardware device</li>\n                <li style={{marginBottom: '0.75rem'}}>{`2. Select your \"${props.walletMode}\" as your Watch-only wallet(Companion App)`}</li>\n                <li style={{marginBottom: '0.75rem'}}> 3. Press the \"Scan Keystone\" button and scan the QR Code displayed on your Keystone hardware wallet</li>\n                <li style={{marginBottom: '0.75rem'}}> 4. Select account and check your watch-only wallet</li>\n            </ul>\n            <div style={{marginBottom: '1rem'}}>\n            <a style={{marginTop: '1.25rem', color:'#784FFE', textDecoration: 'none'}} href={props.link} target=\"_blank\">Click here to view detailed tutorial</a>\n            </div>\n            <Button onClick={props.onButtonClick}>Sync Keystone</Button>    \n        </div>   \n    )\n}","import React, { useMemo, useState } from 'react';\nimport Modal from 'react-modal';\nimport { EventEmitter } from 'events';\nimport { useAnimatedQRCodePlayer } from './useAnimatedQRCodePlayer';\nimport { useAnimatedQRCodeReader } from './useAnimatedQRCodeReader';\nimport { Play, PlayStatus, Read } from '../types';\nimport { InitialPage } from '../components/InitialPage';\n\nconst customStyles = {\n    overlay: {\n        zIndex: 999,\n    },\n    content: {\n        top: '50%',\n        left: '50%',\n        right: 'auto',\n        bottom: 'auto',\n        borderRadius: '10px',\n        width: '37rem',\n        marginRight: '-50%',\n        transform: 'translate(-50%, -50%)',\n        postion: 'relative',\n    },\n};\n\nexport const useController = (): [\n    JSX.Element,\n    {\n        play: Play;\n        read: Read;\n        cameraReady: boolean;\n    },\n] => {\n    const ee = useMemo(() => new EventEmitter(), []);\n    const [visible, setVisible] = useState(false);\n    const [walletMode, setWalltMode] = useState('');\n    const [link, setLink] = useState('');\n    const [mode, setMode] = useState<'read' | 'play' | 'initial' | null>(null);\n    const [AnimatedQRCodePlayer, { play }] = useAnimatedQRCodePlayer();\n    const [AnimatedQRCodeReader, { read, cameraReady }] = useAnimatedQRCodeReader();\n    const close = () => {\n        ee.emit('close');\n        reset();\n    };\n\n    const reset = () => {\n        setMode(null);\n        setLink('');\n        setWalltMode('');\n        setVisible(false);\n    };\n\n    const goToRead = () => {\n        setMode('read');\n    };\n\n    const renderPannel = (pageMode: string) => {\n        if (pageMode === 'initial') {\n            return <InitialPage walletMode={walletMode} link={link} onButtonClick={goToRead} />;\n        } else if (pageMode === 'read') {\n            return AnimatedQRCodeReader;\n        } else if (pageMode === 'play') {\n            return AnimatedQRCodePlayer;\n        } else {\n            return null;\n        }\n    };\n\n    const element = (\n        <Modal isOpen={visible} style={customStyles}>\n            <div onClick={close}>\n                <img\n                    style={{ position: 'absolute', top: '1rem', right: '1rem' }}\n                    src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAADKADAAQAAAABAAAADAAAAAATDPpdAAAAmklEQVQoFZWRwQ3DIAwAa4brJPBP80hnaD/lD5N0iYxEfRVBxBGRwsvgO2PZklJaReTrvX/eTk7O+VVKuTtgDRYVPyOeHAysAFV40jCGEB69aHN/YSRZGK4JVuKu5/DrToDoqnI9tOh4vXJ2Qlc96kSY2lTfWs0m9DCT0r3MSkUrXR9r3eBCNbuDrY/td23z7Vg3wQhGIgcD+wPGY2fPvHuWagAAAABJRU5ErkJggg==\"\n                />\n            </div>\n            <div\n                style={{\n                    width: '35rem',\n                    padding: 18,\n                    flex: 1,\n                    flexDirection: 'column',\n                    alignItems: 'center',\n                    justifyContent: 'center',\n                    color: '#002237',\n                }}\n            >\n                {renderPannel(mode)}\n            </div>\n        </Modal>\n    );\n    return [\n        element,\n        {\n            play: (data, options) => {\n                return new Promise<PlayStatus>(async (resolve) => {\n                    ee.once('close', () => {\n                        resolve(PlayStatus.canceled);\n                    });\n                    setVisible(true);\n                    setMode('play');\n                    await play(data, options);\n                    reset();\n                    resolve(PlayStatus.success);\n                });\n            },\n            read: async (expect, options) => {\n                if (options.renderInitial) {\n                    setWalltMode(options.renderInitial.walletMode);\n                    setLink(options.renderInitial.link);\n                    setMode('initial');\n                    setVisible(true);\n                    const result = await read(expect, options);\n                    reset();\n                    return result;\n                } else {\n                    setMode('read');\n                    setVisible(true);\n                    const result = await read(expect, options);\n                    reset();\n                    return result;\n                }\n            },\n            cameraReady,\n        },\n    ];\n};\n","import {setupSdk} from './service';\nimport { useController } from './hooks/useController';\n\nexport default () => {\n    const [Controller, { read, play, cameraReady }] = useController();\n    setupSdk(read, play, cameraReady);\n    return Controller;\n};\n","import ReactDOM from 'react-dom';\nimport Root from './Root';\nimport React from 'react';\nimport { Play, Read } from './types';\nimport Modal from 'react-modal';\n\nlet initialized = false;\nlet read: Read;\nlet play: Play;\nlet cameraReady: boolean;\n\nconst bootstrap = (): void => {\n    const htmlBody = document.getElementsByTagName('body').item(0) as HTMLBodyElement;\n    const sdkDiv = document.createElement('div');\n    sdkDiv.id = 'kv_sdk_container';\n    htmlBody.appendChild(sdkDiv);\n    Modal.setAppElement('#kv_sdk_container');\n    ReactDOM.render(React.createElement(Root), sdkDiv);\n};\n\nexport const setupSdk = (r: Read, p: Play, status: boolean) => {\n    initialized = true;\n    read = r;\n    play = p;\n    cameraReady = status;\n};\n\nconst sdk = {\n    bootstrap,\n    getSdk: () => {\n        if (initialized) {\n            return {\n                read,\n                play,\n                cameraReady,\n            };\n        } else {\n            throw new Error('SDK is not initialized');\n        }\n    },\n}\n\nexport default sdk;\n"]},"metadata":{},"sourceType":"script"}